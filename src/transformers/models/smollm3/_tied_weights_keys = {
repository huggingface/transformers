    _tied_weights_keys = {
        "cls.predictions.decoder.bias": "cls.predictions.bias",
        "cls.predictions.decoder.weight": "bert.embeddings.word_embeddings.weight"
    }

    _tied_weights_keys = {
        "encoder.embed_tokens.weight": "shared.weight",
        "decoder.embed_tokens.weight": "shared.weight",
    }

    _tied_weights_keys = {
        "lm_head.weight": "model.shared.weight",
    }
    _tied_weights_keys = {"lm_head.weight": "model.language_model.embed_tokens.weight"}

    _tied_weights_keys = {
        "lm_head.decoder.weight": "roberta.embeddings.word_embeddings.weight",
        "lm_head.decoder.bias": "lm_head.bias"
    }

    _tied_weights_keys = {
        "lm_head.decoder.weight": "roberta.embedding.word_embeddings.weight",
        "lm_head.decoder.bias": "lm_head.bias"
    }

tests/models/albert/test_modeling_albert.py : 2 failures
tests/models/bert/test_modeling_bert.py : 2 failures
tests/models/bert_generation/test_modeling_bert_generation.py : 2 failures
tests/models/big_bird/test_modeling_big_bird.py : 2 failures
tests/models/blip_2/test_modeling_blip_2.py : 2 failures
tests/models/codegen/test_modeling_codegen.py : 2 failures
tests/models/convbert/test_modeling_convbert.py : 2 failures
tests/models/d_fine/test_modeling_d_fine.py : 2 failures
tests/models/dab_detr/test_modeling_dab_detr.py : 2 failures
tests/models/data2vec/test_modeling_data2vec_audio.py : 2 failures
tests/models/data2vec/test_modeling_data2vec_text.py : 2 failures
tests/models/deberta/test_modeling_deberta.py : 2 failures
tests/models/deberta_v2/test_modeling_deberta_v2.py : 2 failures
tests/models/distilbert/test_modeling_distilbert.py : 2 failures
tests/models/electra/test_modeling_electra.py : 2 failures
tests/models/ernie/test_modeling_ernie.py : 2 failures
tests/models/flaubert/test_modeling_flaubert.py : 2 failures
tests/models/fnet/test_modeling_fnet.py : 2 failures
tests/models/git/test_modeling_git.py : 2 failures
tests/models/gptj/test_modeling_gptj.py : 2 failures
tests/models/layoutlm/test_modeling_layoutlm.py : 2 failures
tests/models/longformer/test_modeling_longformer.py : 2 failures
tests/models/marian/test_modeling_marian.py : 2 failures
tests/models/megatron_bert/test_modeling_megatron_bert.py : 2 failures
tests/models/mpnet/test_modeling_mpnet.py : 2 failures
tests/models/musicgen/test_modeling_musicgen.py : 2 failures
tests/models/musicgen_melody/test_modeling_musicgen_melody.py : 2 failures
tests/models/nystromformer/test_modeling_nystromformer.py : 2 failures
tests/models/reformer/test_modeling_reformer.py : 2 failures
tests/models/roberta/test_modeling_roberta.py : 2 failures
tests/models/roberta_prelayernorm/test_modeling_roberta_prelayernorm.py : 2 failures
tests/models/roc_bert/test_modeling_roc_bert.py : 2 failures
tests/models/roformer/test_modeling_roformer.py : 2 failures
tests/models/rt_detr/test_modeling_rt_detr.py : 2 failures
tests/models/rt_detr_v2/test_modeling_rt_detr_v2.py : 2 failures
tests/models/squeezebert/test_modeling_squeezebert.py : 2 failures
tests/models/tapas/test_modeling_tapas.py : 2 failures
tests/models/visual_bert/test_modeling_visual_bert.py : 2 failures
tests/models/xmod/test_modeling_xmod.py : 2 failures
tests/models/yoso/test_modeling_yoso.py : 2 failures
tests/models/apertus/test_modeling_apertus.py : 3 failures
tests/models/arcee/test_modeling_arcee.py : 3 failures
tests/models/cwm/test_modeling_cwm.py : 3 failures
tests/models/deepseek_v2/test_modeling_deepseek_v2.py : 3 failures
tests/models/dots1/test_modeling_dots1.py : 3 failures
tests/models/ernie4_5/test_modeling_ernie4_5.py : 3 failures
tests/models/exaone4/test_modeling_exaone4.py : 3 failures
tests/models/flex_olmo/test_modeling_flex_olmo.py : 3 failures
tests/models/funnel/test_modeling_funnel.py : 3 failures
tests/models/glm/test_modeling_glm.py : 3 failures
tests/models/glm4/test_modeling_glm4.py : 3 failures
tests/models/glm4_moe/test_modeling_glm4_moe.py : 3 failures
tests/models/gpt_oss/test_modeling_gpt_oss.py : 3 failures
tests/models/helium/test_modeling_helium.py : 3 failures
tests/models/ibert/test_modeling_ibert.py : 3 failures
tests/models/lfm2/test_modeling_lfm2.py : 3 failures
tests/models/lfm2_moe/test_modeling_lfm2_moe.py : 3 failures
tests/models/llama/test_modeling_llama.py : 3 failures
tests/models/longcat_flash/test_modeling_longcat_flash.py : 3 failures
tests/models/ministral/test_modeling_ministral.py : 3 failures
tests/models/mistral/test_modeling_mistral.py : 3 failures
tests/models/modernbert/test_modeling_modernbert.py : 3 failures
tests/models/modernbert_decoder/test_modeling_modernbert_decoder.py : 3 failures
tests/models/olmo3/test_modeling_olmo3.py : 3 failures
tests/models/phi3/test_modeling_phi3.py : 3 failures
tests/models/pop2piano/test_modeling_pop2piano.py : 3 failures
tests/models/qwen2/test_modeling_qwen2.py : 3 failures
tests/models/qwen2_moe/test_modeling_qwen2_moe.py : 3 failures
tests/models/qwen3/test_modeling_qwen3.py : 3 failures
tests/models/qwen3_moe/test_modeling_qwen3_moe.py : 3 failures
tests/models/seed_oss/test_modeling_seed_oss.py : 3 failures
tests/models/smollm3/test_modeling_smollm3.py : 3 failures
tests/models/starcoder2/test_modeling_starcoder2.py : 3 failures
tests/models/unispeech/test_modeling_unispeech.py : 3 failures
tests/models/wav2vec2_conformer/test_modeling_wav2vec2_conformer.py : 3 failures
tests/models/zamba/test_modeling_zamba.py : 3 failures
tests/models/blt/test_modeling_blt.py : 4 failures
tests/models/edgetam/test_modeling_edgetam.py : 4 failures
tests/models/ernie4_5_moe/test_modeling_ernie4_5_moe.py : 4 failures
tests/models/imagegpt/test_modeling_imagegpt.py : 4 failures
tests/models/mamba/test_modeling_mamba.py : 4 failures
tests/models/mixtral/test_modeling_mixtral.py : 4 failures
tests/models/mra/test_modeling_mra.py : 4 failures
tests/models/sam/test_modeling_sam.py : 4 failures
tests/models/sam2/test_modeling_sam2.py : 4 failures
tests/models/sam_hq/test_modeling_sam_hq.py : 4 failures
tests/models/speecht5/test_modeling_speecht5.py : 4 failures
tests/models/tvp/test_modeling_tvp.py : 4 failures
tests/models/phi/test_modeling_phi.py : 5 failures
tests/models/timm_wrapper/test_modeling_timm_wrapper.py : 5 failures
tests/models/unispeech_sat/test_modeling_unispeech_sat.py : 5 failures
tests/models/grounding_dino/test_modeling_grounding_dino.py : 6 failures
tests/models/mm_grounding_dino/test_modeling_mm_grounding_dino.py : 6 failures
tests/models/udop/test_modeling_udop.py : 6 failures
tests/models/auto/test_modeling_auto.py : 7 failures
tests/models/deformable_detr/test_modeling_deformable_detr.py : 7 failures
tests/models/flava/test_modeling_flava.py : 7 failures
tests/models/minimax/test_modeling_minimax.py : 8 failures
tests/models/bark/test_modeling_bark.py : 10 failures
tests/models/blip/test_modeling_blip.py : 10 failures
tests/models/mllama/test_modeling_mllama.py : 11 failures

tests/models/encoder_decoder/test_modeling_encoder_decoder.py : 12 failures
tests/models/seamless_m4t/test_modeling_seamless_m4t.py : 12 failures


# PROBABLY just 
        if isinstance(input_embeddings, nn.Module):
            for k, v in input_embeddings.named_parameters():
                module, param_type = get_module_from_name(output_embeddings, k)
                setattr(output_embeddings, k, v)


tests/models/d_fine/test_modeling_d_fine.py : 25 failures
tests/models/dab_detr/test_modeling_dab_detr.py : 25 failures
tests/models/rt_detr/test_modeling_rt_detr.py : 25 failures
tests/models/rt_detr_v2/test_modeling_rt_detr_v2.py : 25 failures