# ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุฅุตูุงุญูุง

ุชุญุฏุซ ุงูุฃุฎุทุงุก ุฃุญูุงููุงุ ููููุง ููุง ูููุณุงุนุฏุฉ! ูุบุทู ูุฐุง ุงูุฏููู ุจุนุถ ุงููุดููุงุช ุงูุฃูุซุฑ ุดููุนูุง ุงูุชู ูุงุฌููุงูุง ูููููุฉ ุญููุง. ูุน ุฐููุ ูุง ูููุตุฏ ุจูุฐุง ุงูุฏููู ุฃู ูููู ูุฌููุนุฉ ุดุงููุฉ ููู ูุดููุงุช ๐ค Transformers. ููุฒูุฏ ูู ุงููุณุงุนุฏุฉ ูู ุงุณุชูุดุงู ูุดููุชู ูุฅุตูุงุญูุงุ ุฌุฑุจ ูุง ููู:
<Youtube id="S2EEG3JIt2A"/>


1. ุงุทูุจ ุงููุณุงุนุฏุฉ ุนูู [ุงูููุชุฏูุงุช](https://discuss.huggingface.co/). ููุงู ูุฆุงุช ูุญุฏุฏุฉ ููููู ูุดุฑ ุณุคุงูู ูููุงุ ูุซู [ุงููุจุชุฏุฆูู](https://discuss.huggingface.co/c/beginners/5) ุฃู [๐ค Transformers](https://discuss.huggingface.co/c/transformers/9). ุชุฃูุฏ ูู ูุชุงุจุฉ ููุดูุฑ ุฌูุฏ ููุงุถุญ ุนูู ุงูููุชุฏู ูุน ุจุนุถ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุงุจูุฉ ููุชูุฑุงุฑ ูุฒูุงุฏุฉ ุงุญุชูุงููุฉ ุญู ูุดููุชู!
<Youtube id="_PAli-V4wj0"/>

2. ูู ุจุฅูุดุงุก [ูุดููุฉ](https://github.com/huggingface/transformers/issues/new/choose) ูู ูุณุชูุฏุน ๐ค Transformers ุฅุฐุง ูุงูุช ููุงู ูุดููุฉ ูุชุนููุฉ ุจุงูููุชุจุฉ. ุญุงูู ุชุถููู ุฃูุจุฑ ูุฏุฑ ูููู ูู ุงููุนูููุงุช ุงูุชู ุชุตู ุงููุดููุฉ ููุณุงุนุฏุชูุง ูู ูุนุฑูุฉ ูุง ูู ุงูุฎุทุฃ ูููููุฉ ุฅุตูุงุญู.

3. ุชุญูู ูู ุฏููู [ุงูุชุฑุญูู](migration) ุฅุฐุง ููุช ุชุณุชุฎุฏู ุฅุตุฏุงุฑูุง ุฃูุฏู ูู ููุชุจุฉ ๐ค Transformers ุญูุซ ุชู ุฅุฏุฎุงู ุจุนุถ ุงูุชุบููุฑุงุช ุงููููุฉ ุจูู ุงูุฅุตุฏุงุฑุงุช.


ููุญุตูู ุนูู ูุฒูุฏ ูู ุงูุชูุงุตูู ุญูู ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุฅุตูุงุญูุง ูุงูุญุตูู ุนูู ุงููุณุงุนุฏุฉุ ุฑุงุฌุน [ุงููุตู 8](https://huggingface.co/course/chapter8/1?fw=pt) ูู ุฏูุฑุฉ Hugging Face.

## ุจูุฆุงุช ุฌุฏุงุฑ ุงูุญูุงูุฉ

ุจุนุถ ูุญุฏุงุช ูุนุงูุฌุฉ ุงูุฑุณููุงุช (GPU) ุนูู ุงูุณุญุงุจุฉ ูุฅุนุฏุงุฏุงุช ุงูุดุจูุฉ ุงูุฏุงุฎููุฉ ูุญููุฉ ุจุฌุฏุงุฑ ุญูุงูุฉ ูู ุงูุงุชุตุงูุงุช ุงูุฎุงุฑุฌูุฉุ ููุง ูุคุฏู ุฅูู ุญุฏูุซ ุฎุทุฃ ูู ุงูุงุชุตุงู. ุนูุฏูุง ุชุญุงูู ุชุนูููุงุช ุงูุจุฑูุงูุฌ ุงููุตู ุชูุฒูู ุฃูุฒุงู ุงููููุฐุฌ ุฃู ูุฌููุนุงุช ุงูุจูุงูุงุชุ ุณูุชููู ุงูุชูุฒูู ุซู ููุชูู ุจุฎุทุฃ ูุซู:

```
ValueError: Connection error, and we cannot find the requested files in the cached path.
Please try again or make sure your Internet connection is on.
```

ูู ูุฐู ุงูุญุงูุฉุ ูุฌุจ ูุญุงููุฉ ุชุดุบูู ๐ค Transformers ูู [ูุถุน ุนุฏู ุงูุงุชุตุงู](installation#offline-mode) ูุชุฌูุจ ุฎุทุฃ ุงูุงุชุตุงู.

## CUDA ููุงุฏ ุงูุฐุงูุฑุฉ

ูููู ุฃู ูููู ุชุฏุฑูุจ ุงูููุงุฐุฌ ุงููุจูุฑุฉ ุงูุชู ุชุญุชูู ุนูู ููุงููู ุงููุนููุงุช ุฃูุฑูุง ุตุนุจูุง ุจุฏูู ุงูุฃุฌูุฒุฉ ุงูููุงุณุจุฉ. ุฃุญุฏ ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ ุงูุชู ูุฏ ุชูุงุฌููุง ุนูุฏ ููุงุฏ ุฐุงูุฑุฉ GPU ูู:

```
CUDA out of memory. Tried to allocate 256.00 MiB (GPU 0; 11.17 GiB total capacity; 9.70 GiB already allocated; 179.81 MiB free; 9.85 GiB reserved in total by PyTorch)
```

ูููุง ููู ุจุนุถ ุงูุญููู ุงููุญุชููุฉ ุงูุชู ููููู ุชุฌุฑุจุชูุง ูุชูููู ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ:

- ููู ูู ูููุฉ [`per_device_train_batch_size`](main_classes/trainer#transformers.TrainingArguments.per_device_train_batch_size) ูู [`TrainingArguments`].

- ุญุงูู ุงุณุชุฎุฏุงู [`gradient_accumulation_steps`](main_classes/trainer#transformers.TrainingArguments.gradient_accumulation_steps) ูู [`TrainingArguments`] ูุฒูุงุฏุฉ ุญุฌู ุงูุฏููุนุฉ ุจุดูู ูุนุงู.

<Tip>
ุฑุงุฌุน ุฏููู [ุงูุฃุฏุงุก](performance) ููุฒูุฏ ูู ุงูุชูุงุตูู ุญูู ุชูููุงุช ุชูููุฑ ุงูุฐุงูุฑุฉ.
</Tip>

## ุนุฏู ุงููุฏุฑุฉ ุนูู ุชุญููู ูููุฐุฌ TensorFlow ูุญููุธ

ุชููู ุทุฑููุฉ TensorFlow [model.save](https://www.tensorflow.org/tutorials/keras/save_and_load#save_the_entire_model) ุจุญูุธ ุงููููุฐุฌ ุจุงููุงูู - ุงูููุฏุณุฉ ุงููุนูุงุฑูุฉุ ุงูุฃูุฒุงูุ ุชูููู ุงูุชุฏุฑูุจ - ูู ููู ูุงุญุฏ. ููุน ุฐููุ ุนูุฏ ุชุญููู ููู ุงููููุฐุฌ ูุฑุฉ ุฃุฎุฑูุ ูุฏ ุชูุงุฌู ุฎุทุฃ ูุฃู ููุชุจุฉ ๐ค Transformers ูุฏ ูุง ุชููู ุจุชุญููู ุฌููุน ุงููุงุฆูุงุช ุงููุชุนููุฉ ุจู TensorFlow ูู ููู ุงููููุฐุฌ. ูุชุฌูุจ ุงููุดููุงุช  ุงููุชุนููุฉ ุจุญูุธ ูุชุญููู ููุงุฐุฌ TensorFlowุ ููุตู ุจูุง ููู:

- ุงุญูุธ ุฃูุฒุงู ุงููููุฐุฌ ูููู `h5` ุจุงุณุชุฎุฏุงู [`model.save_weights`](https://www.tensorflow.org/tutorials/keras/save_and_load#save_the_entire_model) ุซู ุฃุนุฏ ุชุญููู ุงููููุฐุฌ ุจุงุณุชุฎุฏุงู [`~TFPreTrainedModel.from_pretrained`]:

```python
>>> from transformers import TFPreTrainedModel
>>> from tensorflow import keras

>>> model.save_weights("some_folder/tf_model.h5")
>>> model = TFPreTrainedModel.from_pretrained("some_folder")
```

- ุงุญูุธ ุงููููุฐุฌ ุจุงุณุชุฎุฏุงู [`~TFPretrainedModel.save_pretrained`] ููู ุจุชุญูููู ูุฑุฉ ุฃุฎุฑู ุจุงุณุชุฎุฏุงู [`~TFPreTrainedModel.from_pretrained`]:

```python
>>> from transformers import TFPreTrainedModel

>>> model.save_pretrained("path_to/model")
>>> model = TFPreTrainedModel.from_pretrained("path_to/model")
```

## ImportError

ุฎุทุฃ ุดุงุฆุน ุขุฎุฑ ูุฏ ุชูุงุฌููุ ุฎุงุตุฉ ุฅุฐุง ูุงู ูููุฐุฌูุง ุชู ุฅุตุฏุงุฑู ุญุฏูุซูุงุ ูู `ImportError`:

```
ImportError: cannot import name 'ImageGPTImageProcessor' from 'transformers' (unknown location)
```

ุจุงููุณุจุฉ ูุฃููุงุน ุงูุฃุฎุทุงุก ูุฐูุ ุชุญูู ูู ุฃู ูุฏูู ุฃุญุฏุซ ุฅุตุฏุงุฑ ูู ููุชุจุฉ Hugging Face Transformers ูุซุจุชูุง ูููุตูู ุฅูู ุฃุญุฏุซ ุงูููุงุฐุฌ:

```bash
pip install transformers --upgrade
```

## ุฎุทุฃ CUDA: ุชู ุชุดุบูู ุงูุชุฃููุฏ ุนูู ุฌุงูุจ ุงูุฌูุงุฒ

ูู ุจุนุถ ุงูุฃุญูุงูุ ูุฏ ุชูุงุฌู ุฎุทุฃ CUDA ุนุงููุง ุญูู ุฎุทุฃ ูู ููุฏ ุงูุฌูุงุฒ.

```
RuntimeError: CUDA error: device-side assert triggered
```

ูุฌุจ ุนููู ูุญุงููุฉ ุชุดุบูู ุงูููุฏ ุนูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ (CPU) ุฃููุงู ููุญุตูู ุนูู ุฑุณุงูุฉ ุฎุทุฃ ุฃูุซุฑ ุฏูุฉ. ุฃุถู ูุชุบูุฑ ุงูุจูุฆุฉ ุงูุชุงูู ูู ุจุฏุงูุฉ ููุฏู ููุชุจุฏูู ุฅูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ:

```python
>>> import os

>>> os.environ["CUDA_VISIBLE_DEVICES"] = ""
```

ุงูุฎูุงุฑ ุงูุขุฎุฑ ูู ุงูุญุตูู ุนูู ุชุชุจุน ููุฏุณ ุฃูุถู ูู GPU. ุฃุถู ูุชุบูุฑ ุงูุจูุฆุฉ ุงูุชุงูู ูู ุจุฏุงูุฉ ููุฏู ููุญุตูู ุนูู ุชุชุจุน ุงูููุฏุณ ููุฅุดุงุฑุฉ ุฅูู ูุตุฏุฑ ุงูุฎุทุฃ:

```python
>>> import os

>>> os.environ["CUDA_LAUNCH_BLOCKING"] = "1"
```

## ุฅุฎุฑุงุฌ ุบูุฑ ุตุญูุญ ุนูุฏ ุนุฏู ุฅุฎูุงุก ุฑููุฒ ุงูุญุดู

ูู ุจุนุถ ุงูุญุงูุงุชุ ูุฏ ูููู `hidden_state` ุบูุฑ ุตุญูุญุฉ ุฅุฐุง ุชุถููุช `input_ids` ุฑููุฒ ุญุดู. ููุฅุซุจุงุช ุฐููุ ูู ุจุชุญููู ูููุฐุฌ ููุฌุฒูุก ูุบูู. ููููู ุงููุตูู ุฅูู `pad_token_id` ูููููุฐุฌ ููุนุฑูุฉ ูููุชู. ูุฏ ุชููู `pad_token_id` `None` ูุจุนุถ ุงูููุงุฐุฌุ ูููู ููููู ุฏุงุฆููุง ุชุนููููุง ูุฏูููุง.

```python
>>> from transformers import AutoModelForSequenceClassification
>>> import torch

>>> model = AutoModelForSequenceClassification.from_pretrained("google-bert/bert-base-uncased")
>>> model.config.pad_token_id
0
```

ููุถุญ ุงููุซุงู ุงูุชุงูู ุงูููุฎุฑุฌุงุช ุจุฏูู ุฅุฎูุงุก ุฑููุฒ ุงูุญุดู:

```python
>>> input_ids = torch.tensor([[7592, 2057, 2097, 2393, 9611, 2115], [7592, 0, 0, 0, 0, 0]])
>>> output = model(input_ids)
>>> print(output.logits)
tensor([[ 0.0082, -0.2307],
[ 0.1317, -0.1683]], grad_fn=<AddmmBackward0>)
```

ููุง ุงูููุฎุฑุฌุงุช ุงููุนููุฉ ููุชุณูุณู ุงูุซุงูู:

```python
>>> input_ids = torch.tensor([[7592]])
>>> output = model(input_ids)
>>> print(output.logits)
tensor([[-0.1008, -0.4061]], grad_fn=<AddmmBackward0>)
```

ูุฌุจ ุนููู ูู ูุนุธู ุงูููุช ุชูููุฑ `attention_mask` ูููููุฐุฌ ูุชุฌุงูู ุฑููุฒ ุงูุญุดู ูุชุฌูุจ ูุฐุง ุงูุฎุทุฃ ุงูุตุงูุช. ุงูุขู ูุชุทุงุจู ููุฎุฑุฌุงุช ุงูุชุณูุณู ุงูุซุงูู ูุน ููุฎุฑุฌุงุชู ุงููุนููุฉ:

<Tip>
ุจุดูู ุงูุชุฑุงุถูุ ููุดุฆ ูุฌุฒูุก ุงููุตูุต `attention_mask` ูู ุงุณุชูุงุฏูุง ุฅูู ุฅุนุฏุงุฏุงุช ุงููุฌุฒูุก ุงููุญุฏุฏ.
</Tip>

```python
>>> attention_mask = torch.tensor([[1, 1, 1, 1, 1, 1], [1, 0, 0, 0, 0, 0]])
>>> output = model(input_ids, attention_mask=attention_mask)
>>> print(output.logits)
tensor([[ 0.0082, -0.2307],
[-0.1008, -0.4061]], grad_fn=<AddmmBackward0>)
```

ูุง ููุดุฆ ๐ค Transformers ุชููุงุฆููุง `attention_mask` ูุฅุฎูุงุก ุฑูุฒ ุงูุญุดู ุฅุฐุง ุชู ุชูููุฑู ูุฃู:

- ุจุนุถ ุงูููุงุฐุฌ ููุณ ููุง ุฑูุฒ ุญุดู.

- ุจุงููุณุจุฉ ูุจุนุถ ุงูุงุณุชุฎุฏุงูุงุชุ ูุฑูุฏ ุงููุณุชุฎุฏููู ุฃู ููุชุจู ุงููููุฐุฌ ุฅูู ุฑูุฒ ุงูุญุดู.
## ValueError: ูุฆุฉ ุงูุชูููู ุบูุฑ ุงููุนุชุฑู ุจูุง XYZ ููุฐุง ุงูููุน ูู AutoModel

ุจุดูู ุนุงูุ ููุตู ุจุงุณุชุฎุฏุงู ูุฆุฉ [`AutoModel`] ูุชุญููู ุงููุณุฎ ุงููุฏุฑุจุฉ ูุณุจููุง ูู ุงูููุงุฐุฌ. ูููู ููุฐู ุงููุฆุฉ ุฃู ุชุณุชูุชุฌ ูุชูุญูู ุชููุงุฆููุง ุงูุจููุฉ ุงูุตุญูุญุฉ ูู ูุณุฎ ูุนููุฉ ุจูุงุกู ุนูู ุงูุชูููู. ุฅุฐุง ุฑุฃูุช ูุฐุง ุงูุฎุทุฃ `ValueError` ุนูุฏ ุชุญููู ูููุฐุฌ ูู ูุณุฎุฉุ ููุฐุง ูุนูู ุฃู ุงููุฆุฉ ุงูุชููุงุฆูุฉ (Auto) ูู ุชุชููู ูู ุงูุนุซูุฑ ุนูู ุฎุฑูุทุฉ ูู ุงูุชูููู ูู ููุทุฉ ุงูุชูุชูุด ุงููุนุทุงุฉ ุฅูู ููุน ุงููููุฐุฌ ุงูุฐู ุชูุญุงูู ุชุญูููู. ูุบุงูุจูุง ูุง ูุญุฏุซ ูุฐุง ุนูุฏูุง ูุง ุชุฏุนู ููุทุฉ ุงูุชูุชูุด ูููุฉ ูุนููุฉ.

ุนูู ุณุจูู ุงููุซุงูุ ุณุชุฑู ูุฐุง ุงูุฎุทุฃ ูู ุงููุซุงู ุงูุชุงูู ูุฃูู ูุง ููุฌุฏ GPT2 ููุฅุฌุงุจุฉ ุนูู ุงูุฃุณุฆูุฉ:

```py
>>> from transformers import AutoProcessor, AutoModelForQuestionAnswering

>>> processor = AutoProcessor.from_pretrained("openai-community/gpt2-medium")
>>> model = AutoModelForQuestionAnswering.from_pretrained("openai-community/gpt2-medium")
ValueError: Unrecognized configuration class <class 'transformers.models.gpt2.configuration_gpt2.GPT2Config'> for this kind of AutoModel: AutoModelForQuestionAnswering.
Model type should be one of AlbertConfig, BartConfig, BertConfig, BigBirdConfig, BigBirdPegasusConfig, BloomConfig, ...
```
