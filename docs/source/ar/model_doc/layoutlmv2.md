# LayoutLMV2

## ูุธุฑุฉ ุนุงูุฉ

ุงูุชุฑุญ ูููุฐุฌ LayoutLMV2 ูู "LayoutLMv2: Multi-modal Pre-training for Visually-Rich Document Understanding" ุจูุงุณุทุฉ ูุงูุบ ุดูุ ููููููุฌ ุดูุ ูุชููุฌุชุดุงู ูููุ ููู ูููุ ูููุฑู ููุ ูุฌูููุณูู ูุงูุฌุ ูููุฌูุงู ููุ ูุฏููุงู ูููุฑูุณููุ ูุชุดุง ุฒูุงูุฌุ ููุงูุดูุงูุฌ ุชุดูุ ูููู ุฒูุงูุฌุ ูููุฏููุฌ ุชุดู. ููุญุณู LayoutLMV2 ูู LayoutLM ููุญุตูู ุนูู ูุชุงุฆุฌ ูุชูุฏูุฉ ูู ุงูุนุฏูุฏ ูู ูุนุงููุฑ ููู ุตูุฑุฉ ุงููุณุชูุฏ:

- ุงุณุชุฎุฑุงุฌ ุงููุนูููุงุช ูู ุงููุณุชูุฏุงุช ุงูููุณูุญุฉ ุถูุฆููุง: ูุฌููุนุฉ ุจูุงูุงุช FUNSD (ูุฌููุนุฉ ูู 199 ูููุฐุฌูุง ุชุถู ุฃูุซุฑ ูู 30000 ูููุฉ)ุ ููุฌููุนุฉ ุจูุงูุงุช CORD (ูุฌููุนุฉ ูู 800 ุฅูุตุงู ููุชุฏุฑูุจุ ู100 ููุชุญููุ ู100 ููุงุฎุชุจุงุฑ)ุ ููุฌููุนุฉ ุจูุงูุงุช SROIE (ูุฌููุนุฉ ูู 626 ุฅูุตุงู ููุชุฏุฑูุจ ู347 ุฅูุตุงู ููุงุฎุชุจุงุฑ)ุ ููุฌููุนุฉ ุจูุงูุงุช Kleister-NDA (ูุฌููุนุฉ ูู ุงุชูุงูุงุช ุนุฏู ุงูุฅูุตุงุญ ูู ูุงุนุฏุฉ ุจูุงูุงุช EDGARุ ุจูุง ูู ุฐูู 254 ูุซููุฉ ููุชุฏุฑูุจุ ู83 ูุซููุฉ ููุชุญููุ ู203 ูุซููุฉ ููุงุฎุชุจุงุฑ).

- ุชุตููู ุตูุฑุฉ ุงููุณุชูุฏ: ูุฌููุนุฉ ุจูุงูุงุช RVL-CDIP (ูุฌููุนุฉ ูู 400000 ุตูุฑุฉ ุชูุชูู ุฅูู ูุงุญุฏุฉ ูู 16 ูุฆุฉ).

- ุงูุฃุณุฆูุฉ ูุงูุฃุฌูุจุฉ ุงูุจุตุฑูุฉ ูููุณุชูุฏ: ูุฌููุนุฉ ุจูุงูุงุช DocVQA (ูุฌููุนุฉ ูู 50000 ุณุคุงู ูุญุฏุฏ ุนูู 12000+ ุตูุฑุฉ ูููุณุชูุฏ).

ููุฎุต ุงููุฑูุฉ ูู ููุง ููู:

* ุฃุซุจุช ุงูุชุฏุฑูุจ ุงููุณุจู ูููุต ูุงูุชุฎุทูุท ูุนุงููุชู ูู ูุฌููุนุฉ ูุชููุนุฉ ูู ููุงู ููู ุงููุณุชูุฏุงุช ุงูุบููุฉ ุจุตุฑููุง ูุฐูู ุจูุถู ุชุตููู ูููุฐุฌ ูุนูุงุฑูุชู ุงููุชููุฒ ูููุฒุฉ ุงููุณุชูุฏุงุช ุงููุจูุฑุฉ ุบูุฑ ุงูููุณููุฉ ุงูููุณูุญุฉ ุถูุฆููุง/ุงูุฑูููุฉ. ููู ูุฐู ุงููุฑูุฉุ ููุฏู LayoutLMv2 ูู ุฎูุงู ุงูุชุฏุฑูุจ ุงููุณุจู ูููุต ูุงูุชุฎุทูุท ูุงูุตูุฑุฉ ูู ุฅุทุงุฑ ูุชุนุฏุฏ ุงููุณุงุฆุทุ ุญูุซ ูุชู ุงูุงุณุชูุงุฏุฉ ูู ุชุตูููุงุช ูุนูุงุฑูุฉ ุฌุฏูุฏุฉ ููููุงุฐุฌ ูููุงู ุงูุชุฏุฑูุจ ุงููุณุจู. ูุนูู ูุฌู ุงูุชุญุฏูุฏุ ูุง ูุณุชุฎุฏู LayoutLMv2 ูููุฉ ููุฐุฌุฉ ุงููุบุฉ ุงููุฑุฆูุฉ ุงููููุนุฉ ุงูููุฌูุฏุฉ ูุญุณุจุ ุจู ูุณุชุฎุฏู ุฃูุถูุง ูููุชู ูุญุงุฐุงุฉ ุงููุต ูุงูุตูุฑุฉ ููุทุงุจูุฉ ุงููุต ูุงูุตูุฑุฉ ุงูุฌุฏูุฏุชูู ูู ูุฑุญูุฉ ุงูุชุฏุฑูุจ ุงููุณุจูุ ุญูุซ ูุชู ุชุนูู ุงูุชูุงุนู ูุชุนุฏุฏ ุงููุณุงุฆุท ุจุดูู ุฃูุถู. ููู ุงูููุช ููุณูุ ูุฅูู ูุฏูุฌ ุฃูุถูุง ุขููุฉ ุงูุชูุงู ุฐุงุชู ูุงุนูุฉ ููุงูููุง ูู ุชุตููู ูุนูุงุฑูุฉ ุงููุญููุ ุจุญูุซ ูููู ูููููุฐุฌ ุฃู ูููู ุชูุงููุง ุงูุนูุงูุฉ ุงูููุถุนูุฉ ุงููุณุจูุฉ ุจูู ูุชู ุงููุต ุงููุฎุชููุฉ. ูุชุธูุฑ ูุชุงุฆุฌ ุงูุชุฌุงุฑุจ ุฃู LayoutLMv2 ูุชููู ุนูู ุงูุฎุทูุท ุงููุงุนุฏูุฉ ุงููููุฉ ููุญูู ูุชุงุฆุฌ ูุชูุฏูุฉ ุฌุฏูุฏุฉ ูู ูุฌููุนุฉ ูุงุณุนุฉ ูู ููุงู ููู ุงููุณุชูุฏุงุช ุงูุบููุฉ ุจุตุฑููุงุ ุจูุง ูู ุฐูู FUNSD (0.7895 -> 0.8420)ุ CORD (0.9493 -> 0.9601)ุ SROIE (0.9524 -> 0.9781)ุ Kleister-NDA (0.834 -> 0.852)ุ RVL-CDIP (0.9443 -> 0.9564)ุ ูDocVQA (0.7295 -> 0.8672). ูููุชุงุญ ูููุฐุฌ LayoutLMv2 ุงููุฏุฑุจ ูุณุจููุง ููุฌูููุฑ ุนูู ูุฐุง ุงูุฑุงุจุท https.*

ูุนุชูุฏ LayoutLMv2 ุนูู detectron2 ูtorchvision ูtesseract. ูู ุจุชุดุบูู ูุง ููู ูุชุซุจูุชูุง:

```bash
python -m pip install 'git+https://github.com/facebookresearch/detectron2.git'
python -m pip install torchvision tesseract
```

(ุฅุฐุง ููุช ุชููู ุจุงูุชุทููุฑ ูู LayoutLMv2ุ ูุงุญุธ ุฃู ุงุฌุชูุงุฒ ุงุฎุชุจุงุฑุงุช doctests ูุชุทูุจ ุฃูุถูุง ุชุซุจูุช ูุฐู ุงูุญุฒู.)

## ูุตุงุฆุญ ุงูุงุณุชุฎุฏุงู

- ุงููุฑู ุงูุฑุฆูุณู ุจูู LayoutLMv1 ูLayoutLMv2 ูู ุฃู ุงูุฃุฎูุฑ ูุชุถูู ุชุถููููุง ุจุตุฑููุง ุฃุซูุงุก ุงูุชุฏุฑูุจ ุงููุณุจู (ุจูููุง ูุถูู LayoutLMv1 ุชุถูููุงุช ุจุตุฑูุฉ ููุท ุฃุซูุงุก ุงูุถุจุท ุงูุฏููู).

- ูุถูู LayoutLMv2 ูููุง ูู ุงูุญูุงุฒ ุงูุงูุชูุงู ุงููุณุจู ุฃุญุงุฏู ุงูุจุนุฏ ูุงูุญูุงุฒ ุงูุงูุชูุงู ุงูููุงูู ุซูุงุฆู ุงูุจุนุฏ ุฅูู ุฏุฑุฌุงุช ุงูุงูุชูุงู ูู ุทุจูุงุช ุงูุงูุชูุงู ุงูุฐุงุชู. ูููู ุงูุนุซูุฑ ุนูู ุงูุชูุงุตูู ูู ุงูุตูุญุฉ 5 ูู ุงููุฑูุฉ.

- ูููู ุงูุนุซูุฑ ุนูู ุฏูุงุชุฑ ุงูููุงุญุธุงุช ุงูุชูุถูุญูุฉ ุญูู ููููุฉ ุงุณุชุฎุฏุงู ูููุฐุฌ LayoutLMv2 ุนูู RVL-CDIP ูFUNSD ูDocVQA ูCORD [ููุง](https://github.com/NielsRogge/Transformers-Tutorials).

- ูุณุชุฎุฏู LayoutLMv2 ุญุฒูุฉ [Detectron2](https://github.com/facebookresearch/detectron2/) ูู Facebook AI ูุนููุฏูุง ุงูููุฑู ุงููุฑุฆู. ุฑุงุฌุน [ูุฐุง ุงูุฑุงุจุท](https://detectron2.readthedocs.io/en/latest/tutorials/install.html) ููุญุตูู ุนูู ุชุนูููุงุช ุงูุชุซุจูุช.

- ุจุงูุฅุถุงูุฉ ุฅูู `input_ids`ุ ูุชููุน [`~LayoutLMv2Model.forward`] ุฅุฏุฎุงููู ุฅุถุงููููุ ูููุง `image` ู`bbox`. ูููุซู ุฅุฏุฎุงู `image` ุตูุฑุฉ ุงููุณุชูุฏ ุงูุฃุตูู ุงูุฐู ุชุธูุฑ ููู ุฑููุฒ ุงููุต. ููุชููุน ุงููููุฐุฌ ุฃู ุชููู ูู ุตูุฑุฉ ูููุณุชูุฏ ุจุญุฌู 224x224. ููุฐุง ูุนูู ุฃูู ุฅุฐุง ูุงู ูุฏูู ุฏูุนุฉ ูู ุตูุฑ ุงููุณุชูุฏุงุชุ ููุฌุจ ุฃู ูููู `image` ุนุจุงุฑุฉ ุนู ูุตูููุฉ ูู ุงูุดูู (batch_sizeุ 3ุ 224ุ 224). ููููู ุฃู ูููู ูุฐุง ุฅูุง `torch.Tensor` ุฃู `Detectron2.structures.ImageList`. ูุง ุชุญุชุงุฌ ุฅูู ุชุทุจูุน ุงููููุงุชุ ุญูุซ ูููู ุงููููุฐุฌ ุจุฐูู. ููู ุงูููู ููุงุญุธุฉ ุฃู ุงูุนููุฏ ุงูููุฑู ุงููุฑุฆู ูุชููุน ูููุงุช BGR ุจุฏูุงู ูู RGBุ ุญูุซ ุฃู ุฌููุน ุงูููุงุฐุฌ ูู Detectron2 ูุชู ุชุฏุฑูุจูุง ูุณุจููุง ุจุงุณุชุฎุฏุงู ุชูุณูู BGR. ูุฅุฏุฎุงู `bbox` ุนุจุงุฑุฉ ุนู ุญุฏูุฏ (ููุงุถุน ุซูุงุฆูุฉ ุงูุฃุจุนุงุฏ) ูุฑููุฒ ุงููุต ุงููุฏุฎูุฉ. ููุฐุง ูุทุงุจู ูู [`LayoutLMModel`]. ููููู ุงูุญุตูู ุนูููุง ุจุงุณุชุฎุฏุงู ูุญุฑู ุงูุชุนุฑู ุงูุถูุฆู ุนูู ุงูุญุฑูู ูุซู [Tesseract](https://github.com/tesseract-ocr/tesseract) ูู Google (ููุฌุฏ [ุบูุงู Python](https://pypi.org/project/pytesseract/) ูุชุงุญ). ูุฌุจ ุฃู ูููู ูู ุญุฏ ูู ุชูุณูู (x0ุ y0ุ x1ุ y1)ุ ุญูุซ ูุชูุงูู (x0ุ y0) ูุน ููุถุน ุงูุฑูู ุงูุนููู ุงูุฃูุณุฑ ูู ุงูุญุฏุ ู(x1ุ y1) ููุซู ููุถุน ุงูุฑูู ุงูุณููู ุงูุฃููู. ูุงุญุธ ุฃูู ูุฌุจ ุฃููุงู ุชุทุจูุน ุงูุญุฏูุฏ ูุชููู ุนูู ูููุงุณ 0-1000. ูุชุทุจูุนุ ููููู ุงุณุชุฎุฏุงู ุงูุฏุงูุฉ ุงูุชุงููุฉ:

```python
def normalize_bbox(bbox, width, height):
    return [
        int(1000 * (bbox[0] / width)),
        int(1000 * (bbox[1] / height)),
        int(1000 * (bbox[2] / width)),
        int(1000 * (bbox[3] / height)),
    ]
```

ููุงุ `width` ู`height` ููุง ุนุฑุถ ูุงุฑุชูุงุน ุงููุณุชูุฏ ุงูุฃุตูู ุงูุฐู ูุญุฏุซ ููู ุงูุฑูุฒ (ูุจู ุชุบููุฑ ุญุฌู ุงูุตูุฑุฉ). ููููู ุงูุญุตูู ุนูููุง ุจุงุณุชุฎุฏุงู ููุชุจุฉ Python Image Library (PIL)ุ ุนูู ุณุจูู ุงููุซุงูุ ููุง ููู:

```python
from PIL import Image

image = Image.open(
    "name_of_your_document - can be a png, jpg, etc. of your documents (PDFs must be converted to images)."
)

width, height = image.size
```

ููุน ุฐููุ ูุชุถูู ูุฐุง ุงููููุฐุฌ ูุนุงูุฌูุง ุฌุฏูุฏูุง ุชูุงููุง [`~transformers.LayoutLMv2Processor`] ูููู ุงุณุชุฎุฏุงูู ูุฅุนุฏุงุฏ ุงูุจูุงูุงุช ูููููุฐุฌ ูุจุงุดุฑุฉ (ุจูุง ูู ุฐูู ุชุทุจูู ุงูุชุนุฑู ุงูุถูุฆู ุนูู ุงูุญุฑูู ุชุญุช ุงูุบุทุงุก). ูููู ุงูุนุซูุฑ ุนูู ูุฒูุฏ ูู ุงููุนูููุงุช ูู ูุณู "ุงูุงุณุชุฎุฏุงู" ุฃุฏูุงู.

- ุฏุงุฎูููุงุ ุณูุฑุณู [`~transformers.LayoutLMv2Model`] ุฅุฏุฎุงู `image` ุนุจุฑ ุนููุฏู ุงูููุฑู ุงููุฑุฆู ููุญุตูู ุนูู ุฎุฑูุทุฉ ููุฒุงุช ุฐุงุช ุฏูุฉ ุฃููุ ูููู ุดูููุง ูุทุงุจููุง ูุณูุฉ `image_feature_pool_shape` ูู [`~transformers.LayoutLMv2Config`]. ูุชู ุจุนุฏ ุฐูู ุชุณุทูุญ ุฎุฑูุทุฉ ุงูููุฒุงุช ูุฐู ููุญุตูู ุนูู ุชุณูุณู ูู ุฑููุฒ ุงูุตูุฑุฉ. ูุจูุง ุฃู ุญุฌู ุฎุฑูุทุฉ ุงูููุฒุงุช ูู 7x7 ุจุดูู ุงูุชุฑุงุถูุ ูุฅููุง ูุญุตู ุนูู 49 ุฑูุฒ ุตูุฑุฉ. ูุชู ุจุนุฏ ุฐูู ุฏูุฌ ูุฐู ุงูุฑููุฒ ูุน ุฑููุฒ ุงููุตุ ูุฅุฑุณุงููุง ุนุจุฑ ูุดูุฑ ุงููุญูู. ููุฐุง ูุนูู ุฃู ุงูุญุงูุงุช ุงููุฎููุฉ ุงูุฃุฎูุฑุฉ ูููููุฐุฌ ุณูููู ููุง ุทูู 512 + 49 = 561ุ ุฅุฐุง ููุช ุจุถุจุท ุฑููุฒ ุงููุต ุญุชู ุงูุทูู ุงูุฃูุตู. ูุจุดูู ุฃูุซุฑ ุนููููุฉุ ุณูููู ููุญุงูุงุช ุงููุฎููุฉ ุงูุฃุฎูุฑุฉ ุดูู `seq_length` + `image_feature_pool_shape[0]` * `config.image_feature_pool_shape[1]`.

- ุนูุฏ ุงุณุชุฏุนุงุก [`~transformers.LayoutLMv2Model.from_pretrained`]`]ุ ุณูุชู ุทุจุงุนุฉ ุชุญุฐูุฑ ูุน ูุงุฆูุฉ ุทูููุฉ ูู ุฃุณูุงุก ุงููุนููุงุช ุงูุชู ูู ูุชู ุชููุฆุชูุง. ููุฐุง ููุณ ูุดููุฉุ ุญูุซ ุฃู ูุฐู ุงููุนููุงุช ูู ุฅุญุตุงุกุงุช ุงูุชุทุจูุน ุจุงูุฏูุนุงุชุ ูุงูุชู ุณูููู ููุง ููู ุนูุฏ ุงูุถุจุท ุงูุฏููู ุนูู ูุฌููุนุฉ ุจูุงูุงุช ูุฎุตุตุฉ.

- ุฅุฐุง ููุช ุชุฑูุฏ ุชุฏุฑูุจ ุงููููุฐุฌ ูู ุจูุฆุฉ ููุฒุนุฉุ ูุชุฃูุฏ ูู ุงุณุชุฏุนุงุก [`synchronize_batch_norm`] ุนูู ุงููููุฐุฌ ูู ุฃุฌู ูุฒุงููุฉ ุทุจูุงุช ุงูุชุทุจูุน ุจุงูุฏูุนุงุช ููุนููุฏ ุงูููุฑู ุงููุฑุฆู ุจุดูู ุตุญูุญ.

ุจุงูุฅุถุงูุฉ ุฅูู ุฐููุ ููุงู LayoutXLMุ ููู ุฅุตุฏุงุฑ ูุชุนุฏุฏ ุงููุบุงุช ูู LayoutLMv2. ูููู ุงูุนุซูุฑ ุนูู ูุฒูุฏ ูู ุงููุนูููุงุช ุนูู [ุตูุญุฉ ุชูุซูู LayoutXLM](layoutxlm).

## ุงูููุงุฑุฏ

ูุงุฆูุฉ ุจููุงุฑุฏ Hugging Face ุงูุฑุณููุฉ ูููุงุฑุฏ ุงููุฌุชูุน (ูุดุงุฑ ุฅูููุง ุจุฑูุฒ ๐) ููุณุงุนุฏุชู ูู ุงูุจุฏุก ุจุงุณุชุฎุฏุงู LayoutLMv2. ุฅุฐุง ููุช ููุชููุง ุจุชูุฏูู ููุฑุฏ ูุฅุฏุฑุงุฌู ููุงุ ููุฑุฌู ูุชุญ ุทูุจ ุณุญุจ Pull Request ูุณูุฑุงุฌุนู! ููุฌุจ ุฃู ูุซุจุช ุงูููุฑุฏ ุดูุฆูุง ุฌุฏูุฏูุง ุจุฏูุงู ูู ุชูุฑุงุฑ ููุฑุฏ ููุฌูุฏ.

<PipelineTag pipeline="text-classification"/>

- ุฏูุชุฑ ููุงุญุธุงุช ุญูู ููููุฉ [ุถุจุท ูููุฐุฌ LayoutLMv2 ุงูุฏููู ูุชุตููู ุงููุตูุต ุนูู ูุฌููุนุฉ ุจูุงูุงุช RVL-CDIP](https://colab.research.google.com/github/NielsRogge/Transformers-Tutorials/blob/master/LayoutLMv2/RVL-CDIP/Fine_tuning_LayoutLMv2ForSequenceClassification_on_RVL_CDIP.ipynb).

- ุฑุงุฌุน ุฃูุถูุง: [ุฏููู ููุงู ุชุตููู ุงููุตูุต](../tasks/sequence_classification)

<PipelineTag pipeline="question-answering"/>

- ุฏูุชุฑ ููุงุญุธุงุช ุญูู ููููุฉ [ุถุจุท ูููุฐุฌ LayoutLMv2 ุงูุฏููู ูุฃุณุฆูุฉ ูุฃุฌูุจุฉ ุนูู ูุฌููุนุฉ ุจูุงูุงุช DocVQA](https://colab.research.google.com/github/NielsRogge/Transformers-Tutorials/blob/master/LayoutLMv2/DocVQA/Fine_tuning_LayoutLMv2ForQuestionAnswering_on_DocVQA.ipynb).

- ุฑุงุฌุน ุฃูุถูุง: [ุฏููู ููุงู ุงูุฃุณุฆูุฉ ูุงูุฃุฌูุจุฉ](../tasks/question_answering)

- ุฑุงุฌุน ุฃูุถูุง: [ุฏููู ููุงู ุงูุฃุณุฆูุฉ ูุงูุฃุฌูุจุฉ ูููุณุชูุฏุงุช](../tasks/document_question_answering)

<PipelineTag pipeline="token-classification"/>

- ุฏูุชุฑ ููุงุญุธุงุช ุญูู ููููุฉ [ุถุจุท ูููุฐุฌ LayoutLMv2 ุงูุฏููู ูุชุตููู ุงูุฑููุฒ ุนูู ูุฌููุนุฉ ุจูุงูุงุช CORD](https://colab.research.google.com/github/NielsRogge/Transformers-Tutorials/blob/master/LayoutLMv2/CORD/Fine_tuning_LayoutLMv2ForTokenClassification_on_CORD.ipynb).

- ุฏูุชุฑ ููุงุญุธุงุช ุญูู ููููุฉ [ุถุจุท ูููุฐุฌ LayoutLMv2 ุงูุฏููู ูุชุตููู ุงูุฑููุฒ ุนูู ูุฌููุนุฉ ุจูุงูุงุช FUNSD](https://colab.research.google.com/github/NielsRogge/Transformers-Tutorials/blob/master/LayoutLMv2/FUNSD/Fine_tuning_LayoutLMv2ForTokenClassification_on_FUNSD_using_HuggingFace_Trainer.ipynb).

- ุฑุงุฌุน ุฃูุถูุง: [ุฏููู ููุงู ุชุตููู ุงูุฑููุฒ](../tasks/token_classification)
## Usage: LayoutLMv2Processor

ุฃุณูู ุทุฑููุฉ ูุฅุนุฏุงุฏ ุงูุจูุงูุงุช ูููููุฐุฌ ูู ุงุณุชุฎุฏุงู [LayoutLMv2Processor]ุ ูุงูุฐู ูุฌูุน ุฏุงุฎููุงู ุจูู ูุนุงูุฌ ุงูุตูุฑ [LayoutLMv2ImageProcessor] ููุญูู ุงูุฑููุฒ [LayoutLMv2Tokenizer] ุฃู [LayoutLMv2TokenizerFast]. ููุชููู ูุนุงูุฌ ุงูุตูุฑ ุงูุชุนุงูู ูุน ุงูุตูุฑุ ุจูููุง ูุชุนุงูู ูุญูู ุงูุฑููุฒ ูุน ุงููุต. ููุฌูุน ุงููุนุงูุฌ ุจูู ุงูุงุซูููุ ููู ูุซุงูู ููููุฐุฌ ูุชุนุฏุฏ ุงููุณุงุฆุท ูุซู LayoutLMv2. ูุงุญุธ ุฃูู ููููู ุงุณุชุฎุฏุงู ูู ููููุง ุจุดูู ูููุตู ุฅุฐุง ููุช ุชุฑูุฏ ุงูุชุนุงูู ูุน ูุณูุท ูุงุญุฏ ููุท.

```python
from transformers import LayoutLMv2ImageProcessor, LayoutLMv2TokenizerFast, LayoutLMv2Processor

image_processor = LayoutLMv2ImageProcessor()  # apply_ocr is set to True by default
tokenizer = LayoutLMv2TokenizerFast.from_pretrained("microsoft/layoutlmv2-base-uncased")
processor = LayoutLMv2Processor(image_processor, tokenizer)
```

ุจุงุฎุชุตุงุฑุ ููููู ุชุฒููุฏ [LayoutLMv2Processor] ุจุตูุฑุฉ ุงููุณุชูุฏ (ูุฑุจูุง ุจูุงูุงุช ุฅุถุงููุฉ)ุ ูุณููุดุฆ ุงููุฏุฎูุงุช ุงูุชู ูุชููุนูุง ุงููููุฐุฌ. ุฏุงุฎููุงูุ ูุณุชุฎุฏู ุงููุนุงูุฌ ุฃููุงู [LayoutLMv2ImageProcessor] ูุชุทุจูู ุงูุชุนุฑู ุงูุถูุฆู ุนูู ุงูุญุฑูู (OCR) ุนูู ุงูุตูุฑุฉ ููุญุตูู ุนูู ูุงุฆูุฉ ุจุงููููุงุช ูุญุฏูุฏ ุงูุตูุงุฏูู ุงููุนูุงุฑูุฉุ ุจุงูุฅุถุงูุฉ ุฅูู ุชุบููุฑ ุญุฌู ุงูุตูุฑุฉ ุฅูู ุญุฌู ูุนูู ููุญุตูู ุนูู ูุฏุฎูุงุช ุงูุตูุฑุฉ. ุซู ูุชู ุชุฒููุฏ ุงููููุงุช ูุญุฏูุฏ ุงูุตูุงุฏูู ุงููุนูุงุฑูุฉ ุฅูู [LayoutLMv2Tokenizer] ุฃู [LayoutLMv2TokenizerFast]ุ ูุงูุฐู ูุญูููุง ุฅูู ุฑููุฒ ุนูู ูุณุชูู ุงูุฑูุฒ `input_ids`ุ ู`attention_mask`ุ ู`token_type_ids`ุ ู`bbox`. ูููููู ุฃูุถูุง ุชุฒููุฏ ุงููุนุงูุฌ ุจุนูุงูุงุช ุงููููุงุชุ ูุงูุชู ูุชู ุชุญููููุง ุฅูู `labels` ุนูู ูุณุชูู ุงูุฑูุฒ.

ูุณุชุฎุฏู [LayoutLMv2Processor] [PyTesseract](https://pypi.org/project/pytesseract/)ุ ููู ุบูุงู Python ุญูู ูุญุฑู ุงูุชุนุฑู ุงูุถูุฆู ุนูู ุงูุญุฑูู (OCR) Tesseract ูู Googleุ ุชุญุช ุงูุบุทุงุก. ูุงุญุธ ุฃูู ููููู ุงุณุชุฎุฏุงู ูุญุฑู ุงูุชุนุฑู ุงูุถูุฆู ุนูู ุงูุญุฑูู (OCR) ุงูุฐู ุชุฎุชุงุฑู ูุชูููุฑ ุงููููุงุช ูุญุฏูุฏ ุงูุตูุงุฏูู ุจููุณู. ูุชุทูุจ ุฐูู ุชููุฆุฉ [LayoutLMv2ImageProcessor] ูุน `apply_ocr` ุชุนููููุง ุนูู `False`.

ููุงู ูุง ูุฌููุนู 5 ุญุงูุงุช ุงุณุชุฎุฏุงู ูุฏุนููุง ุงููุนุงูุฌ. ุฃุฏูุงูุ ูููู ุจุฅุฏุฑุงุฌูุง ุฌููุนูุง. ูุงุญุธ ุฃู ูู ูู ูุฐู ุงูุญุงูุงุช ุงูุงุณุชุฎุฏุงููุฉ ุชุนูู ููู ูู ุงููุฏุฎูุงุช ุงููุฌูุนุฉ ูุบูุฑ ุงููุฌูุนุฉ (ููุถุญูุง ููุฏุฎูุงุช ุบูุฑ ูุฌูุนุฉ).

**ุญุงูุฉ ุงูุงุณุชุฎุฏุงู 1: ุชุตููู ุตูุฑุฉ ุงููุณุชูุฏ (ุงูุชุฏุฑูุจ ูุงูุงุณุชุฏูุงู) + ุชุตููู ุงูุฑููุฒ (ุงูุงุณุชุฏูุงู)ุ apply_ocr = True**

ูุฐู ูู ุงูุญุงูุฉ ุงูุฃูุซุฑ ุจุณุงุทุฉุ ูุงูุชู ุณูุคุฏู ูููุง ุงููุนุงูุฌ (ูู ุงููุงูุน ูุนุงูุฌ ุงูุตูุฑ) ุฅูู ุงูุชุนุฑู ุงูุถูุฆู ุนูู ุงูุญุฑูู ูู ุงูุตูุฑุฉ ููุญุตูู ุนูู ุงููููุงุช ูุญุฏูุฏ ุงูุตูุงุฏูู ุงููุนูุงุฑูุฉ.

```python
from transformers import LayoutLMv2Processor
from PIL import Image

processor = LayoutLMv2Processor.from_pretrained("microsoft/layoutlmv2-base-uncased")

image = Image.open(
    "name_of_your_document - can be a png, jpg, etc. of your documents (PDFs must be converted to images)."
).convert("RGB")
encoding = processor(
    image, return_tensors="pt"
)  # ููููู ุฃูุถูุง ุฅุถุงูุฉ ุฌููุน ูุนููุงุช ูุญูู ุงูุฑููุฒ ููุง ูุซู padding ุฃู truncation
print(encoding.keys())
# dict_keys(['input_ids', 'token_type_ids', 'attention_mask', 'bbox', 'image'])
```

**ุญุงูุฉ ุงูุงุณุชุฎุฏุงู 2: ุชุตููู ุตูุฑุฉ ุงููุณุชูุฏ (ุงูุชุฏุฑูุจ ูุงูุงุณุชุฏูุงู) + ุชุตููู ุงูุฑููุฒ (ุงูุงุณุชุฏูุงู)ุ apply_ocr=False**

ูู ุญุงูุฉ ุงูุฑุบุจุฉ ูู ุฅุฌุฑุงุก ุงูุชุนุฑู ุงูุถูุฆู ุนูู ุงูุญุฑูู ุจููุณูุ ููููู ุชููุฆุฉ ูุนุงูุฌ ุงูุตูุฑ ูุน `apply_ocr` ุชุนููููุง ุนูู `False`. ูู ูุฐู ุงูุญุงูุฉุ ูุฌุจ ุนููู ุชูููุฑ ุงููููุงุช ูุญุฏูุฏ ุงูุตูุงุฏูู ุงูููุงุจูุฉ (ุงููุนูุงุฑูุฉ) ุจููุณู ูููุนุงูุฌ.

```python
from transformers import LayoutLMv2Processor
from PIL import Image

processor = LayoutLMv2Processor.from_pretrained("microsoft/layoutlmv2-base-uncased", revision="no_ocr")

image = Image.open(
    "name_of_your_document - can be a png, jpg, etc. of your documents (PDFs must be converted to images)."
).convert("RGB")
words = ["hello", "world"]
boxes = [[1, 2, 3, 4], [5, 6, 7, 8]]  # ุชุฃูุฏ ูู ุชุทุจูุน ุญุฏูุฏ ุงูุตูุงุฏูู ุงูุฎุงุตุฉ ุจู
encoding = processor(image, words, boxes=boxes, return_tensors="pt")
print(encoding.keys())
# dict_keys(['input_ids', 'token_type_ids', 'attention_mask', 'bbox', 'image'])
```

**ุญุงูุฉ ุงูุงุณุชุฎุฏุงู 3: ุชุตููู ุงูุฑููุฒ (ุงูุชุฏุฑูุจ)ุ apply_ocr=False**

ุจุงููุณุจุฉ ูููุงู ุชุตููู ุงูุฑููุฒ (ูุซู FUNSD ูCORD ูSROIE ูKleister-NDA)ุ ููููู ุฃูุถูุง ุชูููุฑ ุนูุงูุงุช ุงููููุงุช ุงูููุงุจูุฉ ูุชุฏุฑูุจ ุงููููุฐุฌ. ุณูููู ุงููุนุงูุฌ ุจุนุฏ ุฐูู ุจุชุญููููุง ุฅูู `labels` ุนูู ูุณุชูู ุงูุฑูุฒ. ุจุดูู ุงูุชุฑุงุถูุ ุณูููู ุจุชุณููุฉ ุฃูู ูููุฉ ููุท ูู ุงููููุฉุ ูุชุณููุฉ ุงููููุงุช ุงููุชุจููุฉ ุจู -100ุ ูุงูุชู ูู `ignore_index` ูู PyTorch's CrossEntropyLoss. ูู ุญุงูุฉ ุงูุฑุบุจุฉ ูู ุชุณููุฉ ุฌููุน ุงููููุงุช ูู ุงููููุฉุ ููููู ุชููุฆุฉ ูุญูู ุงูุฑููุฒ ูุน `only_label_first_subword` ุชุนููููุง ุนูู `False`.

```python
from transformers import LayoutLMv2Processor
from PIL import Image

processor = LayoutLMv2Processor.from_pretrained("microsoft/layoutlmv2-base-uncased", revision="no_ocr")

image = Image.open(
    "name_of_your_document - can be a png, jpg, etc. of your documents (PDFs must be converted to images)."
).convert("RGB")
words = ["hello", "world"]
boxes = [[1, 2, 3, 4], [5, 6, 7, 8]]  # ุชุฃูุฏ ูู ุชุทุจูุน ุญุฏูุฏ ุงูุตูุงุฏูู ุงูุฎุงุตุฉ ุจู
word_labels = [1, 2]
encoding = processor(image, words, boxes=boxes, word_labels=word_labels, return_tensors="pt")
print(encoding.keys())
# dict_keys(['input_ids', 'token_type_ids', 'attention_mask', 'bbox', 'labels', 'image'])
```

**ุญุงูุฉ ุงูุงุณุชุฎุฏุงู 4: ุงูุฅุฌุงุจุฉ ุนูู ุงูุฃุณุฆูุฉ ุงููุฑุฆูุฉ (ุงูุงุณุชุฏูุงู)ุ apply_ocr=True**

ุจุงููุณุจุฉ ูููุงู ุงูุฅุฌุงุจุฉ ุนูู ุงูุฃุณุฆูุฉ ุงููุฑุฆูุฉ (ูุซู DocVQA)ุ ููููู ุชุฒููุฏ ุงููุนุงูุฌ ุจุณุคุงู. ุจุดูู ุงูุชุฑุงุถูุ ุณูููู ุงููุนุงูุฌ ุจุชุทุจูู ุงูุชุนุฑู ุงูุถูุฆู ุนูู ุงูุญุฑูู ูู ุงูุตูุฑุฉุ ูุฅูุดุงุก ุฑููุฒ [CLS] ููุฃุณุฆูุฉ [SEP] ูููููุงุช [SEP].

```python
from transformers import LayoutLMv2Processor
from PIL import Image

processor = LayoutLMv2Processor.from_pretrained("microsoft/layoutlmv2-base-uncased")

image = Image.open(
    "name_of_your_document - can be a png, jpg, etc. of your documents (PDFs must be converted to images)."
).convert("RGB")
question = "What's his name?"
encoding = processor(image, question, return_tensors="pt")
print(encoding.keys())
# dict_keys(['input_ids', 'token_type_ids', 'attention_mask', 'bbox', 'image'])
```

**ุญุงูุฉ ุงูุงุณุชุฎุฏุงู 5: ุงูุฅุฌุงุจุฉ ุนูู ุงูุฃุณุฆูุฉ ุงููุฑุฆูุฉ (ุงูุงุณุชุฏูุงู)ุ apply_ocr=False**

ุจุงููุณุจุฉ ูููุงู ุงูุฅุฌุงุจุฉ ุนูู ุงูุฃุณุฆูุฉ ุงููุฑุฆูุฉ (ูุซู DocVQA)ุ ููููู ุชุฒููุฏ ุงููุนุงูุฌ ุจุณุคุงู. ุฅุฐุง ููุช ุชุฑูุฏ ุฅุฌุฑุงุก ุงูุชุนุฑู ุงูุถูุฆู ุนูู ุงูุญุฑูู ุจููุณูุ ููููู ุชุฒููุฏ ุงููุนุงูุฌ ุจุงููููุงุช ูุญุฏูุฏ ุงูุตูุงุฏูู (ุงููุนูุงุฑูุฉ) ุงูุฎุงุตุฉ ุจู.

```python
from transformers import LayoutLMv2Processor
from PIL import Image

processor = LayoutLMv2Processor.from_pretrained("microsoft/layoutlmv2-base-uncased", revision="no_ocr")

image = Image.open(
    "name_of_your_document - can be a png, jpg, etc. of your documents (PDFs must be converted to images)."
).convert("RGB")
question = "What's his name?"
words = ["hello", "world"]
boxes = [[1, 2, 3, 4], [5, 6, 7, 8]]  # ุชุฃูุฏ ูู ุชุทุจูุน ุญุฏูุฏ ุงูุตูุงุฏูู ุงูุฎุงุตุฉ ุจู
encoding = processor(image, question, words, boxes=boxes, return_tensors="pt")
print(encoding.keys())
# dict_keys(['input_ids', 'token_type_ids', 'attention_mask', 'bbox', 'image'])
```

## LayoutLMv2Config

[[autodoc]] LayoutLMv2Config

## LayoutLMv2FeatureExtractor

[[autodoc]] LayoutLMv2FeatureExtractor

- __call__

## LayoutLMv2ImageProcessor

[[autodoc]] LayoutLMv2ImageProcessor

- preprocess

## LayoutLMv2Tokenizer

[[autodoc]] LayoutLMv2Tokenizer

- __call__

- save_vocabulary

## LayoutLMv2TokenizerFast

[[autodoc]] LayoutLMv2TokenizerFast

- __call__

## LayoutLMv2Processor

[[autodoc]] LayoutLMv2Processor

- __call__

## LayoutLMv2Model

[[autodoc]] LayoutLMv2Model

- forward

## LayoutLMv2ForSequenceClassification

[[autodoc]] LayoutLMv2ForSequenceClassification

## LayoutLMv2ForTokenClassification

[[autodoc]] LayoutLMv2ForTokenClassification

## LayoutLMv2ForQuestionAnswering

[[autodoc]] LayoutLMv2ForQuestionAnswering