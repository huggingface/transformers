<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="0" failures="28" skipped="3" tests="31" time="13.840" timestamp="2025-11-12T19:16:51.249459+00:00" hostname="0577-dca3-asp6bk-prxmx160019"><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_eager_matches_sdpa_generate" file="tests/generation/test_utils.py" line="1842" time="0.001"><skipped type="pytest.skip" message="test is slow">/home/ubuntu/transformers/tests/generation/test_utils.py:1843: test is slow</skipped></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_assisted_decoding_sample" file="tests/generation/test_utils.py" line="810" time="0.001"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_assisted_decoding_matches_greedy_search_0_random" file="tests/generation/test_utils.py" line="637" time="0.002"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_generate_continue_from_past_key_values" file="tests/generation/test_utils.py" line="1245" time="0.001"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_generate_from_random_inputs_embeds" file="tests/generation/test_utils.py" line="1059" time="0.001"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_beam_search_generate_dict_output" file="tests/generation/test_utils.py" line="455" time="0.002"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_generate_compile_model_forward_fullgraph" file="tests/generation/test_utils.py" line="1492" time="0.001"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_beam_sample_generate_dict_output" file="tests/generation/test_utils.py" line="578" time="0.002"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_assisted_decoding_matches_greedy_search_1_same" file="tests/generation/test_utils.py" line="637" time="0.000"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_beam_sample_generate" file="tests/generation/test_utils.py" line="560" time="0.000"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_generate_from_inputs_embeds_with_static_cache" file="tests/generation/test_utils.py" line="1185" time="0.000"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_generate_compilation_all_outputs" file="tests/generation/test_utils.py" line="1616" time="0.000"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_generate_methods_with_logits_to_keep" file="tests/generation/test_utils.py" line="1685" time="0.000"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_beam_search_generate" file="tests/generation/test_utils.py" line="440" time="0.000"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_beam_search_generate_dict_outputs_use_cache" file="tests/generation/test_utils.py" line="491" time="0.001"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_generate_continue_from_inputs_embeds" file="tests/generation/test_utils.py" line="1331" time="0.001"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_generate_with_quant_cache" file="tests/generation/test_utils.py" line="1460" time="0.000"><skipped type="pytest.skip" message="test requires optimum-quanto">/home/ubuntu/transformers/tests/generation/test_utils.py:1461: test requires optimum-quanto</skipped></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_generate_with_static_cache" file="tests/generation/test_utils.py" line="1394" time="0.000"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_greedy_generate_dict_outputs" file="tests/generation/test_utils.py" line="332" time="0.000"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_generate_without_input_ids" file="tests/generation/test_utils.py" line="616" time="0.000"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_greedy_generate" file="tests/generation/test_utils.py" line="319" time="0.000"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_inherits_generation_mixin" file="tests/generation/test_utils.py" line="1710" time="0.000"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_left_padding_compatibility" file="tests/generation/test_utils.py" line="907" time="0.000"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_greedy_generate_dict_outputs_use_cache" file="tests/generation/test_utils.py" line="362" time="0.000"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_model_parallel_beam_search" file="tests/generation/test_utils.py" line="535" time="0.000"><skipped type="pytest.skip" message="test requires multiple accelerators">/home/ubuntu/transformers/tests/generation/test_utils.py:536: test requires multiple accelerators</skipped></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_prepare_inputs_for_generation_kwargs_forwards" file="tests/generation/test_utils.py" line="1719" time="0.000"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_past_key_values_format" file="tests/generation/test_utils.py" line="1027" time="0.001"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_prompt_lookup_decoding_matches_greedy_search" file="tests/generation/test_utils.py" line="733" time="0.000"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_prompt_lookup_decoding_stops_at_eos" file="tests/generation/test_utils.py" line="878" time="0.000"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_sample_generate_dict_output" file="tests/generation/test_utils.py" line="409" time="0.000"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase><testcase classname="tests.models.afmoe.test_modeling_afmoe.AfmoeModelTest" name="test_sample_generate" file="tests/generation/test_utils.py" line="396" time="0.001"><failure message="ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)">tests/causal_lm_tester.py:316: in setUp
    self.model_tester = self.model_tester_class(self)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tests/models/afmoe/test_modeling_afmoe.py:63: in __init__
    super().__init__(
tests/causal_lm_tester.py:208: in __init__
    self._verify_and_infer_model_attributes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'tests.models.afmoe.test_modeling_afmoe.AfmoeModelTester'&gt;

    @classmethod
    def _verify_and_infer_model_attributes(cls):
        """
        Verifies that the required tester attributes are set correctly, and infers unset tester attributes.
        Intentionally nitpicks the tester class attributes, to prevent human errors.
        """
        # `base_model_class` is mandatory, and it must be a valid model class.
        base_model_class = getattr(cls, "base_model_class")
        if base_model_class is None or "PreTrainedModel" not in str(base_model_class.__mro__):
&gt;           raise ValueError(
                f"You have inherited from `CausalLMModelTester` but did not set the `base_model_class` "
                f"attribute to a valid model class. (It's set to `{base_model_class}`)"
            )
E           ValueError: You have inherited from `CausalLMModelTester` but did not set the `base_model_class` attribute to a valid model class. (It's set to `None`)

tests/causal_lm_tester.py:72: ValueError</failure></testcase></testsuite></testsuites>